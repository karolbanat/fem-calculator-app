"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var themeSwitcherButtons=document.querySelectorAll(".theme-switcher__radio-btn"),calculator=document.querySelector(".calculator"),valueKeys=calculator.querySelectorAll("button[data-value]"),operationKeys=calculator.querySelectorAll("button[data-operation]"),calculatorOutput=calculator.querySelector("#calculator-output"),loadTheme=function(){var e=localStorage.getItem("theme");e?changeTheme(e):loadPreferedTheme()},changeTheme=function(e){document.body.setAttribute("data-theme",e),checkRadioBtn(e),saveTheme(e)},saveTheme=function(e){localStorage.setItem("theme",e)},loadPreferedTheme=function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";checkRadioBtn(e)},checkRadioBtn=function(t){themeSwitcherButtons.forEach(function(e){e.value===t&&(e.checked=!0)})},Calculator=(themeSwitcherButtons.forEach(function(e){return e.addEventListener("change",function(e){return changeTheme(e.target.value)})}),function(){function e(){_classCallCheck(this,e),_defineProperty(this,"result",0),_defineProperty(this,"operation","="),_defineProperty(this,"buffer","0")}return _createClass(e,[{key:"invokeOperation",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"=";switch(this.operation){case"+":this.result=this.result+parseFloat(this.buffer),this.clearBuffer();break;case"-":this.result=this.result-parseFloat(this.buffer),this.clearBuffer();break;case"/":this.result=this.result/parseFloat(this.buffer),this.clearBuffer();break;case"*":this.result=this.result*parseFloat(this.buffer),this.clearBuffer();break;case"=":(0===this.result||0!==this.result&&"0"!==this.buffer)&&(this.result=parseFloat(this.buffer),this.clearBuffer())}this.setOperation(e)}},{key:"setOperation",value:function(e){this.operation=e}},{key:"reset",value:function(){this.clearBuffer(),this.result=0,this.operation="="}},{key:"clearBuffer",value:function(){this.buffer="0"}},{key:"hasEmptyBuffer",value:function(){return"0"===this.buffer}},{key:"increaseValue",value:function(e){"."===e&&this.buffer.includes(".")||(this.buffer+=e,this.transformLead())}},{key:"decreaseValue",value:function(){this.buffer=this.buffer.slice(0,-1)||"0"}},{key:"transformLead",value:function(){this.trimLeadingZeros(),this.convertLeadingDot()}},{key:"trimLeadingZeros",value:function(){this.buffer=this.buffer.replace(/^0+/,"")||"0"}},{key:"convertLeadingDot",value:function(){this.buffer=this.buffer.replace(/^\./,"0.")}}]),e}()),calc=new Calculator,handleOperationKey=function(e){var t=e.target.dataset.operation;switch(t){case"delete":calc.decreaseValue(),displayOutput(calc.buffer);break;case"reset":calc.reset(),displayOutput(calc.buffer);break;case"-":calc.hasEmptyBuffer()?calc.increaseValue("-"):calc.invokeOperation(t),displayOutput(calc.buffer);break;case"+":case"/":case"*":calc.invokeOperation(t),displayOutput(calc.buffer);break;case"=":calc.invokeOperation(),displayOutput(calc.result)}},displayOutput=function(){return calculatorOutput.innerText=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"0"};valueKeys.forEach(function(e){return e.addEventListener("click",function(e){calc.increaseValue(e.target.dataset.value),displayOutput(calc.buffer)})}),operationKeys.forEach(function(e){return e.addEventListener("click",handleOperationKey)}),loadTheme();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsidGhlbWVTd2l0Y2hlckJ1dHRvbnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYWxjdWxhdG9yIiwicXVlcnlTZWxlY3RvciIsInZhbHVlS2V5cyIsIm9wZXJhdGlvbktleXMiLCJjYWxjdWxhdG9yT3V0cHV0IiwibG9jYWxTdG9yYWdlIiwibG9hZFByZWZlcmVkVGhlbWUiLCJ0aGVtZSIsImNoYW5nZVRoZW1lIiwiY2hlY2tSYWRpb0J0biIsInNhdmVUaGVtZSIsInNldEl0ZW0iLCJ3aW5kb3ciLCJwcmVmZXJlZFRoZW1lIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJidG4iLCJ2YWx1ZSIsImNoZWNrZWQiLCJDYWxjdWxhdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2RlZmluZVByb3BlcnR5IiwibmV4dE9wZXJhdGlvbiIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIm9wZXJhdGlvbiIsInJlc3VsdCIsInBhcnNlRmxvYXQiLCJidWZmZXIiLCJjbGVhckJ1ZmZlciIsInNldE9wZXJhdGlvbiIsImtleSIsImluY2x1ZGVzIiwidHJhbnNmb3JtTGVhZCIsInNsaWNlIiwidHJpbUxlYWRpbmdaZXJvcyIsImNvbnZlcnRMZWFkaW5nRG90IiwicmVwbGFjZSIsImNhbGMiLCJoYW5kbGVPcGVyYXRpb25LZXkiLCJkYXRhc2V0IiwiZGVjcmVhc2VWYWx1ZSIsImRpc3BsYXlPdXRwdXQiLCJyZXNldCIsImhhc0VtcHR5QnVmZmVyIiwiaW5jcmVhc2VWYWx1ZSIsImludm9rZU9wZXJhdGlvbiIsImlubmVyVGV4dCIsImZvckVhY2giLCJsb2FkVGhlbWUiXSwibWFwcGluZ3MiOiI0a0JBQUEsSUFBTUEscUJBQXVCQyxTQUFTQyxpQkFBaUIsNEJBQTRCLEVBRTdFQyxXQUFhRixTQUFTRyxjQUFjLGFBQWEsRUFDakRDLFVBQVlGLFdB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LFVBQUEsR0FBQUEsVUFBQSxHQUFBLEdBQUEsRUFlVnpCLFVBYk9tRCxRQUFHLFNBQUFqQixHQUFBLE9BY1RBLEVBQUloQixpQkFiRytCLFFBQWdCckIsU0FBQUEsR0FjdEJhLEtBYkNJLGNBQWNKLEVBQUFBLE9BQUtWLFFBQU9oQixLQUFBLEVBYzNCOEIsY0FiQ0osS0FBQVYsTUFBQSxDQWNGLENBQUMsQ0FBQyxDQUFBLEVBR0g5QixjQWJHa0QsUUFBQSxTQUFBakIsR0FBQSxPQUFBQSxFQUFBaEIsaUJBQUEsUUFBQXdCLGtCQUFBLENBQUEsQ0FBQSxFQUVIVSxVQUFDIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgdGhlbWVTd2l0Y2hlckJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGhlbWUtc3dpdGNoZXJfX3JhZGlvLWJ0bicpO1xyXG4vKiBjYWx1Y3VsYXRvciBlbGVtZW50cyAqL1xyXG5jb25zdCBjYWxjdWxhdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbGN1bGF0b3InKTtcclxuY29uc3QgdmFsdWVLZXlzID0gY2FsY3VsYXRvci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bZGF0YS12YWx1ZV0nKTtcclxuY29uc3Qgb3BlcmF0aW9uS2V5cyA9IGNhbGN1bGF0b3IucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2RhdGEtb3BlcmF0aW9uXScpO1xyXG5jb25zdCBjYWxjdWxhdG9yT3V0cHV0ID0gY2FsY3VsYXRvci5xdWVyeVNlbGVjdG9yKCcjY2FsY3VsYXRvci1vdXRwdXQnKTtcclxuXHJcbi8qIHRoZW1lIGhhbmRsaW5nICovXHJcbmNvbnN0IGxvYWRUaGVtZSA9ICgpID0+IHtcclxuXHRjb25zdCB0aGVtZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0aGVtZScpO1xyXG5cclxuXHRpZiAodGhlbWUpIGNoYW5nZVRoZW1lKHRoZW1lKTtcclxuXHRlbHNlIGxvYWRQcmVmZXJlZFRoZW1lKCk7XHJcbn07XHJcblxyXG5jb25zdCBjaGFuZ2VUaGVtZSA9IHRoZW1lID0+IHtcclxuXHRkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZSgnZGF0YS10aGVtZScsIHRoZW1lKTtcclxuXHRjaGVja1JhZGlvQnRuKHRoZW1lKTtcclxuXHRzYXZlVGhlbWUodGhlbWUpO1xyXG59O1xyXG5cclxuY29uc3Qgc2F2ZVRoZW1lID0gdGhlbWUgPT4ge1xyXG5cdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0aGVtZScsIHRoZW1lKTtcclxufTtcclxuXHJcbmNvbnN0IGxvYWRQcmVmZXJlZFRoZW1lID0gKCkgPT4ge1xyXG5cdGNvbnN0IHByZWZlcmVkVGhlbWUgPVxyXG5cdFx0d2luZG93Lm1hdGNoTWVkaWEgJiYgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKS5tYXRjaGVzID8gJ2RhcmsnIDogJ2xpZ2h0JztcclxuXHRjaGVja1JhZGlvQnRuKHByZWZlcmVkVGhlbWUpO1xyXG59O1xyXG5cclxuY29uc3QgY2hlY2tSYWRpb0J0biA9IHRoZW1lID0+IHtcclxuXHR0aGVtZVN3aXRjaGVyQnV0dG9ucy5mb3JFYWNoKGJ0biA9PiB7XHJcblx0XHRpZiAoYnRuLnZhbHVlID09PSB0aGVtZSkgYnRuLmNoZWNrZWQgPSB0cnVlO1xyXG5cdH0pO1xyXG59O1xyXG50aGVtZVN3aXRjaGVyQnV0dG9ucy5mb3JFYWNoKGJ0biA9PiBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiBjaGFuZ2VUaGVtZShlLnRhcmdldC52YWx1ZSkpKTtcclxuLyogdGhlbWUgaGFuZGxpbmcgZW5kICovXHJcblxyXG4vKiBjYWxjdWxhdG9yIGhhbmRsaW5nICovXHJcbmNsYXNzIENhbGN1bGF0b3Ige1xyXG5cdHJlc3VsdCA9IDAuMDtcclxuXHRvcGVyYXRpb24gPSAnPSc7IC8vICc9JyB0cmVhdGVkIGFzIGRlZmF1bHQgb3BlcmF0aW9uXHJcblx0YnVmZmVyID0gJzAnO1xyXG5cclxuXHRpbnZva2VPcGVyYXRpb24obmV4dE9wZXJhdGlvbiA9ICc9Jykge1xyXG5cdFx0c3dpdGNoICh0aGlzLm9wZXJhdGlvbikge1xyXG5cdFx0XHRjYXNlICcrJzpcclxuXHRcdFx0XHR0aGlzLnJlc3VsdCA9IHRoaXMucmVzdWx0ICsgcGFyc2VGbG9hdCh0aGlzLmJ1ZmZlcik7XHJcblx0XHRcdFx0dGhpcy5jbGVhckJ1ZmZlcigpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICctJzpcclxuXHRcdFx0XHR0aGlzLnJlc3VsdCA9IHRoaXMucmVzdWx0IC0gcGFyc2VGbG9hdCh0aGlzLmJ1ZmZlcik7XHJcblx0XHRcdFx0dGhpcy5jbGVhckJ1ZmZlcigpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICcvJzpcclxuXHRcdFx0XHR0aGlzLnJlc3VsdCA9IHRoaXMucmVzdWx0IC8gcGFyc2VGbG9hdCh0aGlzLmJ1ZmZlcik7XHJcblx0XHRcdFx0dGhpcy5jbGVhckJ1ZmZlcigpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICcqJzpcclxuXHRcdFx0XHR0aGlzLnJlc3VsdCA9IHRoaXMucmVzdWx0ICogcGFyc2VGbG9hdCh0aGlzLmJ1ZmZlcik7XHJcblx0XHRcdFx0dGhpcy5jbGVhckJ1ZmZlcigpO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlICc9JzpcclxuXHRcdFx0XHQvKiBhZnRlciBwcmVzc2luZyAnPScgb3BlcmF0aW9uIGlmIHRoZXJlIGlzIG5vIHJlc3VsdFxyXG4gICAgICAgICAgb3IgdGhlcmUgaXMgcmVzdWx0IGFuZCBub24gZW1wdHkgYnVmZmVyIChtZWFuaW5nIGJ1ZmZlciBuZWVkcyB0byByZXBsYWNlIHJlc3VsdCksXHJcbiAgICAgICAgICBtb3ZlIGJ1ZmZlciB0byByZXN1bHQgYW5kIGNsZWFyIGJ1ZmZlciAqL1xyXG5cdFx0XHRcdGlmICh0aGlzLnJlc3VsdCA9PT0gMCB8fCAodGhpcy5yZXN1bHQgIT09IDAgJiYgdGhpcy5idWZmZXIgIT09ICcwJykpIHtcclxuXHRcdFx0XHRcdHRoaXMucmVzdWx0ID0gcGFyc2VGbG9hdCh0aGlzLmJ1ZmZlcik7XHJcblx0XHRcdFx0XHR0aGlzLmNsZWFyQnVmZmVyKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc2V0T3BlcmF0aW9uKG5leHRPcGVyYXRpb24pO1xyXG5cdH1cclxuXHJcblx0c2V0T3BlcmF0aW9uKG9wZXJhdGlvbikge1xyXG5cdFx0dGhpcy5vcGVyYXRpb24gPSBvcGVyYXRpb247XHJcblx0fVxyXG5cclxuXHRyZXNldCgpIHtcclxuXHRcdHRoaXMuY2xlYXJCdWZmZXIoKTtcclxuXHRcdHRoaXMucmVzdWx0ID0gMC4wO1xyXG5cdFx0dGhpcy5vcGVyYXRpb24gPSAnPSc7XHJcblx0fVxyXG5cclxuXHRjbGVhckJ1ZmZlcigpIHtcclxuXHRcdHRoaXMuYnVmZmVyID0gJzAnO1xyXG5cdH1cclxuXHJcblx0aGFzRW1wdHlCdWZmZXIoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5idWZmZXIgPT09ICcwJztcclxuXHR9XHJcblxyXG5cdGluY3JlYXNlVmFsdWUodmFsdWUpIHtcclxuXHRcdGlmICh2YWx1ZSA9PT0gJy4nICYmIHRoaXMuYnVmZmVyLmluY2x1ZGVzKCcuJykpIHJldHVybjtcclxuXHJcblx0XHR0aGlzLmJ1ZmZlciArPSB2YWx1ZTtcclxuXHRcdHRoaXMudHJhbnNmb3JtTGVhZCgpO1xyXG5cdH1cclxuXHJcblx0ZGVjcmVhc2VWYWx1ZSgpIHtcclxuXHRcdHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuc2xpY2UoMCwgLTEpIHx8ICcwJztcclxuXHR9XHJcblxyXG5cdHRyYW5zZm9ybUxlYWQoKSB7XHJcblx0XHR0aGlzLnRyaW1MZWFkaW5nWmVyb3MoKTtcclxuXHRcdHRoaXMuY29udmVydExlYWRpbmdEb3QoKTtcclxuXHR9XHJcblxyXG5cdHRyaW1MZWFkaW5nWmVyb3MoKSB7XHJcblx0XHQvKiByZW1vdmUgbGVhZGluZyB6ZXJvcyAqL1xyXG5cdFx0dGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5yZXBsYWNlKC9eMCsvLCAnJykgfHwgJzAnO1xyXG5cdH1cclxuXHJcblx0Y29udmVydExlYWRpbmdEb3QoKSB7XHJcblx0XHQvKiBpZiB0aGVyZSBpcyBkb3QgYXQgdGhlIHN0YXJ0LCByZXBsYWNlIGl0IHdpdGggMC4gKi9cclxuXHRcdHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIucmVwbGFjZSgvXlxcLi8sICcwLicpO1xyXG5cdH1cclxufVxyXG5cclxuY29uc3QgY2FsYyA9IG5ldyBDYWxjdWxhdG9yKCk7XHJcblxyXG5jb25zdCBoYW5kbGVPcGVyYXRpb25LZXkgPSBlID0+IHtcclxuXHRjb25zdCBvcGVyYXRpb24gPSBlLnRhcmdldC5kYXRhc2V0Lm9wZXJhdGlvbjtcclxuXHRzd2l0Y2ggKG9wZXJhdGlvbikge1xyXG5cdFx0Y2FzZSAnZGVsZXRlJzpcclxuXHRcdFx0Y2FsYy5kZWNyZWFzZVZhbHVlKCk7XHJcblx0XHRcdGRpc3BsYXlPdXRwdXQoY2FsYy5idWZmZXIpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ3Jlc2V0JzpcclxuXHRcdFx0Y2FsYy5yZXNldCgpO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuYnVmZmVyKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICctJzpcclxuXHRcdFx0LyogaWYgbm8gdmFsdWUgcHJvdmlkZWQsIHRoZW4gYWRkICctJyBzaWduIGF0IHRoZSBmcm9udCAodHJlYXRpbmcgaXQgYXMgdmFsdWUpLFxyXG4gICAgICAgIGVsc2UgdHJlYXQgaXQgYXMgc3VidHJhY3Rpbmcgb3BlcmF0aW9uICovXHJcblx0XHRcdGlmIChjYWxjLmhhc0VtcHR5QnVmZmVyKCkpIGNhbGMuaW5jcmVhc2VWYWx1ZSgnLScpO1xyXG5cdFx0XHRlbHNlIGNhbGMuaW52b2tlT3BlcmF0aW9uKG9wZXJhdGlvbik7XHJcblxyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuYnVmZmVyKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICcrJzpcclxuXHRcdGNhc2UgJy8nOlxyXG5cdFx0Y2FzZSAnKic6XHJcblx0XHRcdGNhbGMuaW52b2tlT3BlcmF0aW9uKG9wZXJhdGlvbik7XHJcblx0XHRcdGRpc3BsYXlPdXRwdXQoY2FsYy5idWZmZXIpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJz0nOlxyXG5cdFx0XHRjYWxjLmludm9rZU9wZXJhdGlvbigpO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMucmVzdWx0KTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgZGlzcGxheU91dHB1dCA9ICh2YWx1ZSA9ICcwJykgPT4gKGNhbGN1bGF0b3JPdXRwdXQuaW5uZXJUZXh0ID0gdmFsdWUpO1xyXG5cclxudmFsdWVLZXlzLmZvckVhY2goa2V5ID0+XHJcblx0a2V5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XHJcblx0XHRjYWxjLmluY3JlYXNlVmFsdWUoZS50YXJnZXQuZGF0YXNldC52YWx1ZSk7XHJcblx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuYnVmZmVyKTtcclxuXHR9KVxyXG4pO1xyXG5cclxub3BlcmF0aW9uS2V5cy5mb3JFYWNoKGtleSA9PiBrZXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVPcGVyYXRpb25LZXkpKTtcclxuXHJcbmxvYWRUaGVtZSgpO1xyXG4iXX0=
