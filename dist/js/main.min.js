"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var themeSwitcherButtons=document.querySelectorAll(".theme-switcher__radio-btn"),calculator=document.querySelector(".calculator"),valueKeys=calculator.querySelectorAll("button[data-value]"),operationKeys=calculator.querySelectorAll("button[data-operation]"),calculatorOutput=calculator.querySelector("#calculator-output"),loadTheme=function(){var e=localStorage.getItem("theme");e?changeTheme(e):loadPreferedTheme()},changeTheme=function(e){document.body.setAttribute("data-theme",e),checkRadioBtn(e),saveTheme(e)},saveTheme=function(e){localStorage.setItem("theme",e)},loadPreferedTheme=function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";checkRadioBtn(e)},checkRadioBtn=function(t){themeSwitcherButtons.forEach(function(e){e.value===t&&(e.checked=!0)})},Calculator=(themeSwitcherButtons.forEach(function(e){return e.addEventListener("change",function(e){return changeTheme(e.target.value)})}),function(){function e(){_classCallCheck(this,e),_defineProperty(this,"result",0),_defineProperty(this,"operation","="),_defineProperty(this,"buffer","0")}return _createClass(e,[{key:"invokeOperation",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"=";switch(this.operation){case"+":this.result=this.result+parseFloat(this.buffer),this.clearBuffer();break;case"-":this.result=this.result-parseFloat(this.buffer),this.clearBuffer();break;case"/":this.result=this.result/parseFloat(this.buffer),this.clearBuffer();break;case"*":this.result=this.result*parseFloat(this.buffer),this.clearBuffer();break;case"=":(0===this.result||0!==this.result&&"0"!==this.buffer)&&(this.result=parseFloat(this.buffer),this.clearBuffer())}this.setOperation(e)}},{key:"setOperation",value:function(e){this.operation=e}},{key:"reset",value:function(){this.clearBuffer(),this.result=0,this.operation="="}},{key:"clearBuffer",value:function(){this.buffer="0"}},{key:"hasEmptyBuffer",value:function(){return"0"===this.buffer}},{key:"increaseValue",value:function(e){"."===e&&this.buffer.includes(".")||(this.buffer+=e,this.transformLead())}},{key:"decreaseValue",value:function(){this.buffer=this.buffer.slice(0,-1)||"0"}},{key:"formattedResult",value:function(){return this.result.toString().replace(/[^\.]+/,function(e){return parseInt(e).toLocaleString("en-US")})}},{key:"formattedBuffer",value:function(){return this.buffer.replace(/[^\.]+/,function(e){return parseInt(e).toLocaleString("en-US")})}},{key:"transformLead",value:function(){this.trimLeadingZeros(),this.convertLeadingDot()}},{key:"trimLeadingZeros",value:function(){this.buffer=this.buffer.replace(/^0+/,"")||"0"}},{key:"convertLeadingDot",value:function(){this.buffer=this.buffer.replace(/^\./,"0.")}}]),e}()),calc=new Calculator,handleOperationKey=function(e){var t=e.target.dataset.operation;switch(t){case"delete":calc.decreaseValue(),displayOutput(calc.formattedBuffer());break;case"reset":calc.reset(),displayOutput(calc.formattedBuffer());break;case"-":calc.hasEmptyBuffer()?calc.increaseValue("-"):calc.invokeOperation(t),displayOutput(calc.formattedBuffer());break;case"+":case"/":case"*":calc.invokeOperation(t),displayOutput(calc.formattedBuffer());break;case"=":calc.invokeOperation(),displayOutput(calc.formattedResult())}},displayOutput=function(){return calculatorOutput.innerText=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"0"};valueKeys.forEach(function(e){return e.addEventListener("click",function(e){calc.increaseValue(e.target.dataset.value),displayOutput(calc.formattedBuffer())})}),operationKeys.forEach(function(e){return e.addEventListener("click",handleOperationKey)}),loadTheme();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsidGhlbWVTd2l0Y2hlckJ1dHRvbnMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjYWxjdWxhdG9yIiwicXVlcnlTZWxlY3RvciIsInZhbHVlS2V5cyIsIm9wZXJhdGlvbktleXMiLCJjYWxjdWxhdG9yT3V0cHV0IiwibG9jYWxTdG9yYWdlIiwibG9hZFByZWZlcmVkVGhlbWUiLCJ0aGVtZSIsImNoYW5nZVRoZW1lIiwiY2hlY2tSYWRpb0J0biIsInNhdmVUaGVtZSIsInNldEl0ZW0iLCJ3aW5kb3ciLCJwcmVmZXJlZFRoZW1lIiwibWF0Y2hNZWRpYSIsIm1hdGNoZXMiLCJidG4iLCJ2YWx1ZSIsImNoZWNrZWQiLCJDYWxjdWxhdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJ0YXJnZXQiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2RlZmluZVByb3BlcnR5IiwibmV4dE9wZXJhdGlvbiIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsIm9wZXJhdGlvbiIsInJlc3VsdCIsInBhcnNlRmxvYXQiLCJidWZmZXIiLCJjbGVhckJ1ZmZlciIsInNldE9wZXJhdGlvbiIsImtleSIsImluY2x1ZGVzIiwidHJhbnNmb3JtTGVhZCIsInNsaWNlIiwidG9TdHJpbmciLCJtYXRjaCIsInBhcnNlSW50IiwidG9Mb2NhbGVTdHJpbmciLCJyZXBsYWNlIiwidHJpbUxlYWRpbmdaZXJvcyIsImNvbnZlcnRMZWFkaW5nRG90IiwiY2FsYyIsImhhbmRsZU9wZXJhdGlvbktleSIsImRhdGFzZXQiLCJkZWNyZWFzZVZhbHVlIiwiZGlzcGxheU91dHB1dCIsImZvcm1hdHRlZEJ1ZmZlciIsInJlc2V0IiwiaGFzRW1wdHlCdWZmZXIiLCJpbmNyZWFzZVZhbHVlIiwiaW52b2tlT3BlcmF0aW9uIiwiaW5uZXJUZXh0IiwiZm9yRWFjaCIsImxvYWRUaGVtZSJdLCJtYXBwaW5ncyI6IjRrQkFBQSxJQUFNQSxxQkFBdUJD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QXNCRUYsY0FyQkRKLEtBQUFLLGdCQUFBLENBQUEsRUFzQkMsTUFDRCxJQXJCRCxJQUFDTCxLQUVETyxlQUFBLEVBQUFQLEtBQUFRLGNBQW9CLEdBQUEsRUFDbkJSLEtBQUFTLGdCQUFBMUIsQ0FBQSxFQXdCQ3FCLGNBdEJGSixLQUFBSyxnQkFBQSxDQUFBLEVBQUMsTUFBQSxJQUFBLElBQUEsSUFBQSxJQUdGLElBQU1MLElBRU5BLEtBQU1DLGdCQUFrQmxCLENBQUcsRUFDMUJxQixjQUFlSixLQUFLekIsZ0JBQWVRLENBQUFBLEVBQ25DLE1BdUJDLElBdEJBLElBdUJDaUIsS0F0QkFBLGdCQUFLRyxFQXVCTEMsY0F0QkFBLEtBQWNKLGdCQUFLSyxDQUFBQSxDQUNuQixDQXdCSCxFQXBCR0QsY0FBQSxXQUFBLE9BQUEvQyxpQkFBQXFELFVBQUEsRUFBQTlCLFVBQUFDLFFBQUFDLEtBQUFBLElBQUFGLFVBQUEsR0FBQUEsVUFBQSxHQUFBLEdBQUEsRUF3Qkh6QixVQXRCR3dELFFBQUEsU0FBQXRCLEdBQUEsT0FDSEEsRUFBQWhCLGlCQUFBLFFBQUEsU0FBQUMsR0F1QkUwQixLQXRCQ1EsY0FBU0QsRUFBQUEsT0FBY0wsUUFBU00sS0FBQUEsRUF1QmpDSixjQXBCQ0EsS0FBY0osZ0JBQUtLLENBQUFBLENBcUJyQixDQUFDLENBQUMsQ0FBQSxFQUdIakQsY0FwQlV1RCxRQUFBLFNBQUF0QixHQUFBLE9BQUFBLEVBQUFoQixpQkFBQSxRQUFBNEIsa0JBQUEsQ0FBQSxDQUFBLEVBc0JWVyxVQXBCR1IiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB0aGVtZVN3aXRjaGVyQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50aGVtZS1zd2l0Y2hlcl9fcmFkaW8tYnRuJyk7XHJcbi8qIGNhbHVjdWxhdG9yIGVsZW1lbnRzICovXHJcbmNvbnN0IGNhbGN1bGF0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FsY3VsYXRvcicpO1xyXG5jb25zdCB2YWx1ZUtleXMgPSBjYWxjdWxhdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbltkYXRhLXZhbHVlXScpO1xyXG5jb25zdCBvcGVyYXRpb25LZXlzID0gY2FsY3VsYXRvci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bZGF0YS1vcGVyYXRpb25dJyk7XHJcbmNvbnN0IGNhbGN1bGF0b3JPdXRwdXQgPSBjYWxjdWxhdG9yLnF1ZXJ5U2VsZWN0b3IoJyNjYWxjdWxhdG9yLW91dHB1dCcpO1xyXG5cclxuLyogdGhlbWUgaGFuZGxpbmcgKi9cclxuY29uc3QgbG9hZFRoZW1lID0gKCkgPT4ge1xyXG5cdGNvbnN0IHRoZW1lID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3RoZW1lJyk7XHJcblxyXG5cdGlmICh0aGVtZSkgY2hhbmdlVGhlbWUodGhlbWUpO1xyXG5cdGVsc2UgbG9hZFByZWZlcmVkVGhlbWUoKTtcclxufTtcclxuXHJcbmNvbnN0IGNoYW5nZVRoZW1lID0gdGhlbWUgPT4ge1xyXG5cdGRvY3VtZW50LmJvZHkuc2V0QXR0cmlidXRlKCdkYXRhLXRoZW1lJywgdGhlbWUpO1xyXG5cdGNoZWNrUmFkaW9CdG4odGhlbWUpO1xyXG5cdHNhdmVUaGVtZSh0aGVtZSk7XHJcbn07XHJcblxyXG5jb25zdCBzYXZlVGhlbWUgPSB0aGVtZSA9PiB7XHJcblx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RoZW1lJywgdGhlbWUpO1xyXG59O1xyXG5cclxuY29uc3QgbG9hZFByZWZlcmVkVGhlbWUgPSAoKSA9PiB7XHJcblx0Y29uc3QgcHJlZmVyZWRUaGVtZSA9XHJcblx0XHR3aW5kb3cubWF0Y2hNZWRpYSAmJiB3aW5kb3cubWF0Y2hNZWRpYSgnKHByZWZlcnMtY29sb3Itc2NoZW1lOiBkYXJrKScpLm1hdGNoZXMgPyAnZGFyaycgOiAnbGlnaHQnO1xyXG5cdGNoZWNrUmFkaW9CdG4ocHJlZmVyZWRUaGVtZSk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja1JhZGlvQnRuID0gdGhlbWUgPT4ge1xyXG5cdHRoZW1lU3dpdGNoZXJCdXR0b25zLmZvckVhY2goYnRuID0+IHtcclxuXHRcdGlmIChidG4udmFsdWUgPT09IHRoZW1lKSBidG4uY2hlY2tlZCA9IHRydWU7XHJcblx0fSk7XHJcbn07XHJcbnRoZW1lU3dpdGNoZXJCdXR0b25zLmZvckVhY2goYnRuID0+IGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IGNoYW5nZVRoZW1lKGUudGFyZ2V0LnZhbHVlKSkpO1xyXG4vKiB0aGVtZSBoYW5kbGluZyBlbmQgKi9cclxuXHJcbi8qIGNhbGN1bGF0b3IgaGFuZGxpbmcgKi9cclxuY2xhc3MgQ2FsY3VsYXRvciB7XHJcblx0cmVzdWx0ID0gMC4wO1xyXG5cdG9wZXJhdGlvbiA9ICc9JzsgLy8gJz0nIHRyZWF0ZWQgYXMgZGVmYXVsdCBvcGVyYXRpb25cclxuXHRidWZmZXIgPSAnMCc7XHJcblxyXG5cdGludm9rZU9wZXJhdGlvbihuZXh0T3BlcmF0aW9uID0gJz0nKSB7XHJcblx0XHRzd2l0Y2ggKHRoaXMub3BlcmF0aW9uKSB7XHJcblx0XHRcdGNhc2UgJysnOlxyXG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gdGhpcy5yZXN1bHQgKyBwYXJzZUZsb2F0KHRoaXMuYnVmZmVyKTtcclxuXHRcdFx0XHR0aGlzLmNsZWFyQnVmZmVyKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJy0nOlxyXG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gdGhpcy5yZXN1bHQgLSBwYXJzZUZsb2F0KHRoaXMuYnVmZmVyKTtcclxuXHRcdFx0XHR0aGlzLmNsZWFyQnVmZmVyKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJy8nOlxyXG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gdGhpcy5yZXN1bHQgLyBwYXJzZUZsb2F0KHRoaXMuYnVmZmVyKTtcclxuXHRcdFx0XHR0aGlzLmNsZWFyQnVmZmVyKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJyonOlxyXG5cdFx0XHRcdHRoaXMucmVzdWx0ID0gdGhpcy5yZXN1bHQgKiBwYXJzZUZsb2F0KHRoaXMuYnVmZmVyKTtcclxuXHRcdFx0XHR0aGlzLmNsZWFyQnVmZmVyKCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgJz0nOlxyXG5cdFx0XHRcdC8qIGFmdGVyIHByZXNzaW5nICc9JyBvcGVyYXRpb24gaWYgdGhlcmUgaXMgbm8gcmVzdWx0XHJcbiAgICAgICAgICBvciB0aGVyZSBpcyByZXN1bHQgYW5kIG5vbiBlbXB0eSBidWZmZXIgKG1lYW5pbmcgYnVmZmVyIG5lZWRzIHRvIHJlcGxhY2UgcmVzdWx0KSxcclxuICAgICAgICAgIG1vdmUgYnVmZmVyIHRvIHJlc3VsdCBhbmQgY2xlYXIgYnVmZmVyICovXHJcblx0XHRcdFx0aWYgKHRoaXMucmVzdWx0ID09PSAwIHx8ICh0aGlzLnJlc3VsdCAhPT0gMCAmJiB0aGlzLmJ1ZmZlciAhPT0gJzAnKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5yZXN1bHQgPSBwYXJzZUZsb2F0KHRoaXMuYnVmZmVyKTtcclxuXHRcdFx0XHRcdHRoaXMuY2xlYXJCdWZmZXIoKTtcclxuXHRcdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZXRPcGVyYXRpb24obmV4dE9wZXJhdGlvbik7XHJcblx0fVxyXG5cclxuXHRzZXRPcGVyYXRpb24ob3BlcmF0aW9uKSB7XHJcblx0XHR0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjtcclxuXHR9XHJcblxyXG5cdHJlc2V0KCkge1xyXG5cdFx0dGhpcy5jbGVhckJ1ZmZlcigpO1xyXG5cdFx0dGhpcy5yZXN1bHQgPSAwLjA7XHJcblx0XHR0aGlzLm9wZXJhdGlvbiA9ICc9JztcclxuXHR9XHJcblxyXG5cdGNsZWFyQnVmZmVyKCkge1xyXG5cdFx0dGhpcy5idWZmZXIgPSAnMCc7XHJcblx0fVxyXG5cclxuXHRoYXNFbXB0eUJ1ZmZlcigpIHtcclxuXHRcdHJldHVybiB0aGlzLmJ1ZmZlciA9PT0gJzAnO1xyXG5cdH1cclxuXHJcblx0aW5jcmVhc2VWYWx1ZSh2YWx1ZSkge1xyXG5cdFx0LyogZG9uJ3QgYWRkICcuJyBpZiBpdCBpcyBwcmVzZW50ICovXHJcblx0XHRpZiAodmFsdWUgPT09ICcuJyAmJiB0aGlzLmJ1ZmZlci5pbmNsdWRlcygnLicpKSByZXR1cm47XHJcblxyXG5cdFx0dGhpcy5idWZmZXIgKz0gdmFsdWU7XHJcblx0XHR0aGlzLnRyYW5zZm9ybUxlYWQoKTtcclxuXHR9XHJcblxyXG5cdGRlY3JlYXNlVmFsdWUoKSB7XHJcblx0XHR0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKDAsIC0xKSB8fCAnMCc7XHJcblx0fVxyXG5cclxuXHQvKiBmb3JtYXR0aW5nICovXHJcblx0Zm9ybWF0dGVkUmVzdWx0KCkge1xyXG5cdFx0cmV0dXJuIHRoaXMucmVzdWx0LnRvU3RyaW5nKCkucmVwbGFjZSgvW15cXC5dKy8sIG1hdGNoID0+IHBhcnNlSW50KG1hdGNoKS50b0xvY2FsZVN0cmluZygnZW4tVVMnKSk7XHJcblx0fVxyXG5cclxuXHRmb3JtYXR0ZWRCdWZmZXIoKSB7XHJcblx0XHQvKiBzZWFyY2hlcyBmb3IgbnVtYmVycyBiZWZvcmUgJy4nIGFuZCBmb3JtYXRzIGl0ICovXHJcblx0XHRyZXR1cm4gdGhpcy5idWZmZXIucmVwbGFjZSgvW15cXC5dKy8sIG1hdGNoID0+IHBhcnNlSW50KG1hdGNoKS50b0xvY2FsZVN0cmluZygnZW4tVVMnKSk7XHJcblx0fVxyXG5cclxuXHR0cmFuc2Zvcm1MZWFkKCkge1xyXG5cdFx0dGhpcy50cmltTGVhZGluZ1plcm9zKCk7XHJcblx0XHR0aGlzLmNvbnZlcnRMZWFkaW5nRG90KCk7XHJcblx0fVxyXG5cclxuXHR0cmltTGVhZGluZ1plcm9zKCkge1xyXG5cdFx0LyogcmVtb3ZlIGxlYWRpbmcgemVyb3MgKi9cclxuXHRcdHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIucmVwbGFjZSgvXjArLywgJycpIHx8ICcwJztcclxuXHR9XHJcblxyXG5cdGNvbnZlcnRMZWFkaW5nRG90KCkge1xyXG5cdFx0LyogaWYgdGhlcmUgaXMgZG90IGF0IHRoZSBzdGFydCwgcmVwbGFjZSBpdCB3aXRoIDAuICovXHJcblx0XHR0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnJlcGxhY2UoL15cXC4vLCAnMC4nKTtcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNhbGMgPSBuZXcgQ2FsY3VsYXRvcigpO1xyXG5cclxuY29uc3QgaGFuZGxlT3BlcmF0aW9uS2V5ID0gZSA9PiB7XHJcblx0Y29uc3Qgb3BlcmF0aW9uID0gZS50YXJnZXQuZGF0YXNldC5vcGVyYXRpb247XHJcblx0c3dpdGNoIChvcGVyYXRpb24pIHtcclxuXHRcdGNhc2UgJ2RlbGV0ZSc6XHJcblx0XHRcdGNhbGMuZGVjcmVhc2VWYWx1ZSgpO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuZm9ybWF0dGVkQnVmZmVyKCkpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ3Jlc2V0JzpcclxuXHRcdFx0Y2FsYy5yZXNldCgpO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuZm9ybWF0dGVkQnVmZmVyKCkpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJy0nOlxyXG5cdFx0XHQvKiBpZiBubyB2YWx1ZSBwcm92aWRlZCwgdGhlbiBhZGQgJy0nIHNpZ24gYXQgdGhlIGZyb250ICh0cmVhdGluZyBpdCBhcyB2YWx1ZSksXHJcbiAgICAgICAgZWxzZSB0cmVhdCBpdCBhcyBzdWJ0cmFjdGluZyBvcGVyYXRpb24gKi9cclxuXHRcdFx0aWYgKGNhbGMuaGFzRW1wdHlCdWZmZXIoKSkgY2FsYy5pbmNyZWFzZVZhbHVlKCctJyk7XHJcblx0XHRcdGVsc2UgY2FsYy5pbnZva2VPcGVyYXRpb24ob3BlcmF0aW9uKTtcclxuXHJcblx0XHRcdGRpc3BsYXlPdXRwdXQoY2FsYy5mb3JtYXR0ZWRCdWZmZXIoKSk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnKyc6XHJcblx0XHRjYXNlICcvJzpcclxuXHRcdGNhc2UgJyonOlxyXG5cdFx0XHRjYWxjLmludm9rZU9wZXJhdGlvbihvcGVyYXRpb24pO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuZm9ybWF0dGVkQnVmZmVyKCkpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJz0nOlxyXG5cdFx0XHRjYWxjLmludm9rZU9wZXJhdGlvbigpO1xyXG5cdFx0XHRkaXNwbGF5T3V0cHV0KGNhbGMuZm9ybWF0dGVkUmVzdWx0KCkpO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcbn07XHJcblxyXG5jb25zdCBkaXNwbGF5T3V0cHV0ID0gKHZhbHVlID0gJzAnKSA9PiAoY2FsY3VsYXRvck91dHB1dC5pbm5lclRleHQgPSB2YWx1ZSk7XHJcblxyXG52YWx1ZUtleXMuZm9yRWFjaChrZXkgPT5cclxuXHRrZXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcclxuXHRcdGNhbGMuaW5jcmVhc2VWYWx1ZShlLnRhcmdldC5kYXRhc2V0LnZhbHVlKTtcclxuXHRcdGRpc3BsYXlPdXRwdXQoY2FsYy5mb3JtYXR0ZWRCdWZmZXIoKSk7XHJcblx0fSlcclxuKTtcclxuXHJcbm9wZXJhdGlvbktleXMuZm9yRWFjaChrZXkgPT4ga2V5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlT3BlcmF0aW9uS2V5KSk7XHJcblxyXG5sb2FkVGhlbWUoKTtcclxuIl19
